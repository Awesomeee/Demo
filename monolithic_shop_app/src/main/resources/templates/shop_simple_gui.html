<!DOCTYPE HTML>
<html>
	<head>
		<link href="/css/bootstrap.min.css" rel="stylesheet" />
		<script src="/js/bootstrap.bundle.min.js" ></script> 
		<style>
			.loader {
			  border: 16px solid #f3f3f3; /* Light grey */
			  border-top: 16px solid #3498db; /* Blue */
			  border-radius: 50%;
			  width: 120px;
			  height: 120px;
			  animation: spin 2s infinite;
			}
			
			@keyframes spin {
			  0% { transform: rotate(0deg); }
			  100% { transform: rotate(360deg); }
			}
		</style>
		
	</head>
	<body>
		<div id="loading" style="display:flex;justify-content:center;margin-top:300px">
			<div class="loader"></div>
		</div>
		
		<div id="main_content">
			<h1>Welcome to the shop</h1>
			<table id="productTable" class="table table-hover">
				<thead>
					<tr>
						<th scope="col">ID</th>
						<th>Name</th>
						<th>Description</th>
						<th>Price</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th scope="row">1</th>
						<td>table- sample data</td>
						<td>Good for education- sample data</td>
						<td>10000 VND- sample data</td>
					</tr>
				</tbody>
			</table>
			<div style="display:flex">
				<button onclick="slidePrevPage()" id="table_prev_btn" style="flex:1;margin-right:5px">Prev</button>
				<button onclick="turnNextPage()" id="table_next_btn" style="flex:1">Next</button>
				<div style="flex:7"></div>
			</div>
		</div>
		
		<script>
			let currentPage = 0;
		
			
			
			function loadProductData() {
				
				document.getElementById("main_content").style.display = "none";
				let loadUri = 'http://localhost:8080/api/products?page='+currentPage+'&size=2&sort=id&direction=asc';
			
				fetch(loadUri, {
				      method: 'GET',
				      headers: {
				        'Content-Type': 'text/plain', // 'application/json',
				      },
				      //body: JSON.stringify({ title: 'New Post', content: 'Some content' }),
				    })
				      .then(response => response.text())
				      .then(outputData => {
				    	  				let products = JSON.parse(outputData);
				    	  				let dataList = products.products;
				    	  				let table = document.getElementById("productTable");
				    	  				table.getElementsByTagName("tbody")[0].remove();
				    	  				let tbody = document.createElement("tbody"); 	  				
				    	  				for(let i=0;i<dataList.length;i++) {
				    	  					let tr = document.createElement("tr");
				    	  					let th = document.createElement("th");
				    	  					th.setAttribute("scope","row");
				    	  					th.innerHTML = i + 1 + currentPage*2;
				    	  					let td_1 = document.createElement("td");
				    	  					td_1.innerHTML = dataList[i].name;
				    	  					let td_2 = document.createElement("td");
				    	  					td_2.innerHTML = dataList[i].description;
				    	  					let td_3 = document.createElement("td");
				    	  					td_3.innerHTML = dataList[i].price + " " + dataList[i].currency;
				    	  					tr.append(th);
				    	  					tr.append(td_1);
				    	  					tr.append(td_2);
				    	  					tr.append(td_3);
				    	  					tbody.append(tr);
				    	  				}
				    	  				table.append(tbody);
				    	  				document.getElementById("loading").style.display = "none";
				    	  				document.getElementById("main_content").style.display = "initial";
				    	  			});
			
			}
			
			
			function slidePrevPage() {
				currentPage--;
				document.getElementById("loading").style.display = "flex";
				loadProductData();
			}
			
			function turnNextPage() {
				currentPage++;
				document.getElementById("loading").style.display = "flex";
				loadProductData();
			}
			
			loadProductData();
		</script>
	</body>
</html>